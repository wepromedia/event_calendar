!function(e,a,t){"use strict";var n={init:function(a){return this.each(function(t,n){var i=e(".event_calendar_container").length+1;e(this).attr("data-calendar-id",i),e(this).attr("id","calendar_id_"+i);var c=e.extend({api:["./json/calendar.json"],week:["日","月","火","水","木","金","土"],width:"100%",thema:"calendar_default",target_obj:!1,calender_icon:!0,target_click:!0,title_format:"YYYY/MM",id:i},a),l=e(this);l.data("option",c);d(this,c),r(l,c)})},getOption:function(a){if(a)var t=e(a);else var t=e(this);return t.data("option")},setOption:function(a,t){if(t)var n=e(t);else var n=e(this);return n.each(function(t,n){var r=e.extend(e(this).data("option"),a),d=e(this);d.data("option",r)})},open:function(a){if(a)var t=e(a);else var t=e(this);var r=n.getOption(t),d="";if(r.target_obj&&e(r.target_obj)){var c=_(r.target_obj);Date.parse(c)&&(d=new Date(c),s(r.target_obj,d))}return""==d&&(d=new Date),i(t,r,d),t.find(".event_calendar_container").addClass("open"),t.find(".event_calendar_icon").addClass("on"),this},close:function(a){if(a)var t=e(a);else var t=e(this);n.setOption({now_month:!1},t),t.find(".event_calendar_container").fadeOut(),t.find(".event_calendar_container").removeClass("open"),t.find(".event_calendar_icon").removeClass("on")},destroy:function(){}},r=function(a,t){e(document).on("mousedown",function(r){if(0==a.find(".event_calendar_container").hasClass("open"))return!0;var d=e(r.target).closest(".event_calendar_container").length,i=e(r.target).closest(t.target_obj).length,c=e(r.target).closest(".event_calendar_icon").length;t.target_obj&&t.target_click&&t.calender_icon?!d&&t.calender_icon&&!c&&t.target_obj&&t.target_click&&!i&&n.close(a):d||!t.calender_icon||c?!d&&t.target_obj&&t.target_click&&!i&&n.close(a):n.close(a)}),t.target_obj&&t.target_click&&e(document).on("focus",t.target_obj,function(){n.open(a)}),t.calender_icon&&e(document).on("mouseup","#calendar_id_"+t.id+" .event_calendar_icon",function(a){e(this).hasClass("on")?n.close(e(this).parent()):n.open(e(this).parent())})},d=function(a,t){var n=e(a);n.addClass(t.thema),t.calender_icon&&n.append('<a href="javascript:void(0);" class="event_calendar_icon"></a>');var r='<div class="event_calendar_container">';r+='<div class="event_calendar_bg"></div>',r+='<div class="event_calendar_container_inner">',r+='<div class="event_calendar_header">',r+='<div class="event_calendar_header_inner">',r+='<div class="event_calendar_header_prev_btn"><a href="javascript:void(0);">&lt;</a></div>',r+='<div class="event_calendar_header_title">2016年12月</div>',r+='<div class="event_calendar_header_next_btn"><a href="javascript:void(0);">&gt;</a></div>',r+="</div>",r+="</div>",r+='<div class="event_calendar_body">',r+='<table class="event_calendar_table">',r+="</table>",r+="</div>",r+='<div class="event_calendar_result"></div>',r+='<div class="copyright"><a href="https://wepromedia.net/">Event Calendar by Wepromedia Original</a></div>',r+="</div></div>",n.append(r),n.find(".event_calendar_container_inner").css({width:t.width})},i=function(a,t,r){var d=e(a),i=r.getFullYear(),_=r.getMonth()+1,s=(r.getDate(),i+"-"+("00"+_).slice(-2)),v=new Date(i,_-1,1),f=new Date(i,_,0),p=f.getDate(),h=v.getDay(),u=Math.ceil((p+h)/7),g="<tr>";for(m=0;m<7;m++)g+="<th>"+t.week[m]+"</th>";g+="</tr><tr>";for(var b=1,m=0;m<h;m++)g+='<td class="calendar_none">&nbsp;</td>';for(var j=0;j<u;j++){if(0==j)for(var w=h;w<7;w++)g+=l(b,s,t),b++;else{g+="<tr>";for(var w=0;w<7;w++)g+=p>=b?l(b,s,t):'<td class="calendar_none">&nbsp;</td>',b++}g+="</tr>"}n.setOption({now_month:s},a);var y=c(i,("00"+_).slice(-2),t.title_format);d.find(".event_calendar_header_title").html(y),d.find(".event_calendar_table").empty(),d.find(".event_calendar_result").empty(),d.find(".event_calendar_table").append(g),o(a,t,r),d.find(".event_calendar_container").fadeIn()},c=function(e,a,t){var n=t.split(/YYYY|MM/);return e+n[1]+a+n[2]},l=function(e,a,n){var r=a+"-"+("00"+e).slice(-2);if(n.target_obj){var d=_(n.target_obj);if(d==r)var i="now"}i==t&&(i="");var c='<td data-calendar_date="'+r+'" class="'+i+'"><div class="calendar_date">'+e+'</div><div class="calendar_event"></div></td>';return c},o=function(a,n,r){var d=e(a),i=r.getMonth()+1,c={date:r.getFullYear()+"-"+("00"+i).slice(-2)};Array.isArray(n.api)||(n.api=[n.api]),e.each(n.api,function(a,n){e.ajax({url:n,type:"post",data:c,timeout:1e4,dataType:"json",success:function(a,n,r){a.length>0&&e.each(a,function(e,a){if(a.date==t||a.title==t)return!0;var n=new Date(a.date),r=n.getMonth()+1,i=n.getDate(),c=n.getFullYear()+"-"+("00"+r).slice(-2)+"-"+("00"+i).slice(-2);if(0==d.find("td[data-calendar_date='"+c+"'] .calendar_event").length)return!0;0==d.find("td[data-calendar_date='"+c+"']").hasClass("event_on")&&d.find("td[data-calendar_date='"+c+"']").addClass("event_on");var l='<span class="event_icon"></span>';if(d.find("td[data-calendar_date='"+c+"'] .calendar_event").append(l),0==d.find(".event_calendar_result .calendar_event_detail[data-calendar_date='"+c+"']").length&&d.find(".event_calendar_result").append('<div class="calendar_event_detail" data-calendar_date="'+c+'"><ul></ul></div>'),a.time==t)var o=a.date;else var o=a.date+" "+a.time;var l='<li><div class="event_date">'+o+'</div><div class="event_title">'+a.title+"</div></li>";d.find(".calendar_event_detail[data-calendar_date='"+c+"'] ul").append(l)})},error:function(e,a,t){console.log(result)}})})};e(document).on("click",".event_calendar_header_prev_btn a",function(a){var t=e(this).parents(".event_calendar_container").parent(),r=n.getOption(t),d=new Date(r.now_month);d.setMonth(d.getMonth()-1),i(t,r,d)}),e(document).on("click",".event_calendar_header_next_btn a",function(a){var t=e(this).parents(".event_calendar_container").parent(),r=n.getOption(t),d=new Date(r.now_month);d.setMonth(d.getMonth()+1),i(t,r,d)}),e(document).on("mouseenter",".event_calendar_table td",function(a){var t=e(this).attr("data-calendar_date"),n=e(this).parents(".event_calendar_container").parent();0!=n.find(".calendar_event_detail[data-calendar_date='"+t+"']").length&&n.find(".calendar_event_detail[data-calendar_date='"+t+"']").slideDown()}),e(document).on("mouseleave",".event_calendar_table td",function(a){var t=e(this).attr("data-calendar_date"),n=e(this).parents(".event_calendar_container").parent();0!=n.find(".calendar_event_detail[data-calendar_date='"+t+"']").length&&n.find(".calendar_event_detail[data-calendar_date='"+t+"']").slideUp()}),e(document).on("click",".event_calendar_table td",function(a){var r=e(this).attr("data-calendar_date"),d=e(this).parents(".event_calendar_container").parent();if(r!==t){var i=n.getOption(d),c=new Date(r);s(i.target_obj,c)}n.close(d)});var _=function(a){var t=e(a).prop("tagName");return"INPUT"==t||"TEXTAREA"==t?e(a).val():e(a).text()},s=function(a,t){var n=t.getMonth()+1,r=t.getFullYear()+"-"+("00"+n).slice(-2)+"-"+("00"+t.getDate()).slice(-2),d=e(a).prop("tagName");return"INPUT"==d||"TEXTAREA"==d?e(a).val(r):e(a).text(r)};e.fn.eventCalendar=function(a){return n[a]?n[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof a&&a?void e.error("Method "+a+" does not exist on jQuery.tooltip"):n.init.apply(this,arguments)}}(jQuery);